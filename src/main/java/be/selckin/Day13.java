package be.selckin;

import java.io.IOException;
import java.util.ArrayList;
import java.util.BitSet;
import java.util.List;

public class Day13 {

    public static final String PART1_EXAMPLE = """
            #.##..##.
            ..#.##.#.
            ##......#
            ##......#
            ..#.##.#.
            ..##..##.
            #.#.##.#.
                        
            #...##..#
            #....#..#
            ..##..###
            #####.##.
            #####.##.
            ..##..###
            #....#..#
            """;

    public static void main(String[] args) throws IOException {
        part1(PART1_EXAMPLE, 405, new Smudge(false));
        part1(PART1_INPUT, 27300, new Smudge(false));
        System.out.println("==============");
        part1(PART1_EXAMPLE, 400, new Smudge(true));
        part1(PART1_INPUT, 29276, new Smudge(true));
    }


    private static void part1(String input, long expected, Smudge smudge) {
        List<Pattern> patterns = parse(input);

        int sum = 0;
        for (Pattern pattern : patterns) {
            sum += findMirror(pattern, smudge);
        }

        if (sum != expected)
            throw new RuntimeException("" + sum);
    }

    private static int findMirror(Pattern pattern, Smudge smudge) {
        int hor = findMirror(pattern.horizon(), smudge);
        int vert = findMirror(pattern.vert(), smudge);

        if (vert != -1 && hor != -1) {
            throw new RuntimeException();
        }
        if (vert == -1 && hor == -1)
            throw new RuntimeException();

        if (vert != -1)
            return (vert);
        return 100 * hor;
    }

    public static class Smudge {
        public final boolean enabled;
        public boolean available;

        public Smudge(boolean enabled) {
            this.enabled = enabled;
        }
    }

    private static int findMirror(List<BitSet> items, Smudge smudge) {
        BitSet prev = null;
        for (int i = 0; i < items.size(); i++) {
            BitSet item = items.get(i);

            smudge.available = true;

            if (isEqual(item, prev, smudge)) {
                if (check(items, i, smudge)) {
                    if (!smudge.enabled)
                        return i;
                    else if (!smudge.available)
                        return i;
                }
            }
            prev = item;
        }
        return -1;
    }


    private static boolean isEqual(BitSet item, BitSet prev, Smudge smudge) {
        if (prev == null)
            return false;
        if (!smudge.enabled)
            return item.equals(prev);

        BitSet clone = (BitSet) prev.clone();
        clone.xor(item);

        int cardinality = clone.cardinality();
        if (cardinality == 0)
            return true;

        if (smudge.available && (cardinality == 1)) {
            smudge.available = false;
            return true;
        }
        return false;

    }


    private static boolean check(List<BitSet> items, int start, Smudge smudge) {
        int u = start - 1 - 1;
        int d = start + 1;

        while (u >= 0 && d < items.size()) {
            if (!isEqual(items.get(u), items.get(d), smudge))
                return false;
            u--;
            d++;
        }
        return true;
    }


    private static List<Pattern> parse(String input) {
        List<Pattern> result = new ArrayList<>();

        List<BitSet> rows = new ArrayList<>();

        for (String line : input.lines().toList()) {
            if (line.isEmpty()) {
                result.add(new Pattern(rows, toCols(rows)));
                rows = new ArrayList<>();
            } else {
                BitSet current = new BitSet();
                for (int i = 0; i < line.length(); i++)
                    if (line.charAt(i) == '#')
                        current.set(i);

                rows.add(current);
            }
        }
        result.add(new Pattern(rows, toCols(rows)));
        return result;
    }

    private static List<BitSet> toCols(List<BitSet> rows) {
        int length = rows.stream().mapToInt(BitSet::length).max().getAsInt();

        List<BitSet> cols = new ArrayList<>(length);
        for (int i = 0; i < length; i++) {
            BitSet sb = new BitSet(rows.size());

            for (int j = 0; j < rows.size(); j++) {
                BitSet row = rows.get(j);
                sb.set(j, row.get(i));
            }
            cols.add(sb);
        }
        return cols;
    }


    public record Pattern(List<BitSet> horizon, List<BitSet> vert) {
    }


    public static final String PART1_INPUT = """
            .##.#....####..
            ###....###...##
            .....###..#####
            .....###..#####
            ###....###...##
            .##.#....####..
            #.#..#.#...#.##
            ##..#.##.#.##..
            .#.#.#.#..#.###
            .#.###.#..#..##
            .#..#.....#.###
            ..###.###..##..
            ...#.#..#..####
            #.####.##..#.##
            ..##.##.###.###
            #.#.##.#..#.###
            #..###...###.#.
                        
            ....##..##...
            ..#..####..#.
            .############
            .############
            ..#..####..#.
            ....##..##...
            ###......#.##
                        
            .##..#..#.###
            .##.#...#..##
            ..#.######.#.
            .......#.....
            .......#.....
            ..#.######.#.
            .##.#...#..##
            .##..#..#.###
            ####.#####.#.
            ####.#####.#.
            .##.....#.###
                        
            #..##.##.
            #...###..
            ##..###.#
            ##.##..##
            ##.##..##
            ##..###.#
            #...###..
            #..##.##.
            ##.##.###
            ..##.....
            ..#...###
            ..##..#..
            ..#...#..
            ..#...###
            ..##.....
                        
            ..##.##.##...
            ##.#......###
            ..########...
            #####..######
            ..#......#...
            .####..####..
            #....##....##
            ....#..#.....
            #...####...##
            ##.#....#.###
            #...#..#...##
            #####..######
            ##..#..#..###
            .#...##...#..
            ..#.#..#.#...
                        
            .####..
            .####..
            ##..###
            ..##...
            .####..
            ##..###
            #.##.#.
            .####..
            #####.#
                        
            #.#..##..#.#..###
            #.##.##.##.#.####
            #.#......#.#.#...
            #..........#.####
            .##########..#.##
            #..######..####..
            ##...###..##.####
            #..........######
            #.########.#..#..
            .#..#..#..#.###..
            .##..##..##..#...
            #.########.#..#..
            ...#....#...#..##
                        
            #......
            .#.#.#.
            .##..##
            .##...#
            .#.#.#.
            #......
            #.###..
            #.###..
            #......
            .#.#.#.
            .##...#
                        
            .##.##.
            #.##..#
            ....##.
            #..####
            ##.#..#
            ####..#
            .#.....
            ##.#...
            ..#.##.
            ###.##.
            ###.##.
                        
            ....#.##.
            #.#....#.
            #.#....#.
            ....#.###
            .#....###
            .####.##.
            ...##....
            ##.######
            .##.#....
            #..#.##.#
            .####.###
            #...####.
            #...####.
                        
            ..##...###..#..#.
            ..##...###..#..#.
            ####.#.#.#..#.#.#
            ..###.#....#.####
            ##.###.#####...##
            ...#.#...##..#...
            ...#..###....#..#
            ###.....#......#.
            #.###...#####.##.
            ..###.#.##..#..#.
            ..#####.#.#......
            ###....#.#.#..##.
            ..#.####.##.#....
                        
            .###..#.#
            .###..#.#
            ..##.##.#
            #.#####.#
            #.#.#####
            .###.....
            ##.#.##.#
            .#.###.#.
            #.####.##
            #.####.##
            .#.###.#.
            ##.#.##.#
            .###.#...
                        
            ########.
            ...#.#.##
            #..#####.
            #..#.....
            ..##.#...
            ..##...#.
            ..##...#.
            ..##.#...
            #.##.....
            #..#####.
            ...#.#.##
            ########.
            ##.##.###
            ....#####
            ..#.....#
            ..#.....#
            ....#####
                        
            ....##....#
            .##.#.####.
            #..#.######
            #..###.##.#
            ....#.#..#.
            #.#########
            ....##....#
            #..##......
            #####..##..
            #..#..####.
            .##...#..#.
                        
            ........#......
            .........#.####
            ##....##....#..
            .##..##...##..#
            .##..##.##...#.
            ########.####.#
            ########.####.#
            .##..##.##...#.
            .##..##...##..#
            ##....##....#..
            .........#.####
            ........#......
            .#...##.#.#...#
            #.#..#.#....##.
            ###..####.####.
            #......#...##.#
            ##########...##
                        
            ##.#.#..#####
            ##.###.#.#...
            .....##..#...
            ####.######..
            .##..###.#.##
            #.####.####..
            .#...#..#.#..
            .###.##..#.##
            ##.##...#####
            #..####.#####
            ...##.....###
            #.#...###..##
            #.#...###..##
            ...##...#.###
            #..####.#####
                        
            ....#..##.#..####
            #.##.######.###.#
            #####.#.#.#.#....
            #####.#.#.#.#....
            #.##.######.###.#
            ....#..####..####
            ..##.#####.....##
            #.#.#....###.#..#
            ..#...#.##.####..
            .##...###.#.###..
            .##...###.#.###..
                        
            .###.#..#.###..
            #.#.#.##.#.#.##
            ..#.######.#...
            ..#...##...#...
            #.##.####..#.##
            ##.########.###
            ..#..####..#...
            #.##......##.##
            ##.#..##..#.###
                        
            ##.#........#.###
            ###..##..##..####
            #..#..#.....#..##
            ...#.##..##.#....
            #..#..#..#..#..##
            ...###.##.###....
            #.#####..#####.##
            ....########.....
            ..#.#..##..#.#...
            .#.###.##.###.#..
            ..##..####..##...
            #.#..#....#..#.##
            .#..##.##.##..#..
            ####..####..#####
            ##.#.##..##.#.###
                        
            #.#.##.#.###..#
            ##......###.##.
            ....##...##....
            ####..######..#
            .##....##.#####
            #........#.....
            ##......####..#
                        
            ..###.#..####
            ..###.###..##
            ..###.###.###
            ..#.#..#....#
            ..#.#..##...#
            ..###.###.###
            ..###.###..##
            ..###.#..####
            ###..#...#.##
            ###....#.#.#.
            ...#.###..##.
            ######.###..#
            ##......#..#.
                        
            .#######.##.#####
            .#...#........#..
            ##...###....###..
            ##...###....###..
            .#...#........#..
            .#######.##.#####
            #.####..####.####
            #.##..########..#
            .#.#...#....#...#
            ..###..#....#..##
            ...#.#..#..#..#.#
                        
            ##.#...##...#
            ...#.#....#.#
            ###.#.####.#.
            ..###.####.##
            ##.#.#....#.#
            ##..#..##..#.
            ......####...
            ##.#.#....#.#
            ..#.##....##.
            ......#..#...
            ...##.####.##
            ..#....##....
            ##...######.#
                        
            ............#.#
            ##.#....#.###..
            .##.#..#.##...#
            ###########..##
            ....####....##.
            #..##..##..##..
            ####....####.#.
            ...#.##.#......
            #..#....#..###.
            .#........#.###
            .#.#....#.#...#
            .##......##.###
            ....####....#..
            ##.#....#.##.##
            #..######..###.
            #...#..#...###.
            #...#..#...###.
                        
            .#..#.#.#
            .#..#.#.#
            ....##..#
            #.#######
            ##..#..#.
            .#.#.#..#
            ...#....#
            .###..#.#
            ...#..###
            .#.##.##.
            #####...#
            #####...#
            .#.##.##.
            ...#..###
            .####.#.#
            ...#....#
            .#.#.#..#
                        
            ##.#.#.
            ###..##
            ##.#.##
            .###...
            .###...
            ##.#.##
            ###..##
            ##.#.#.
            ...###.
            .#.###.
            ##.#.#.
            ###..##
            ##.#.##
                        
            .####..##
            .#.##..##
            ##.######
            .....##..
            ###..##..
            ....#..#.
            ##.######
            ....####.
            .#.#....#
                        
            #.#..#.#.##..##
            ........#.#####
            ...##....#..##.
            .#.##.####.###.
            ########.#.#.##
            ##.##.##..##..#
            ..#..#..##..#.#
            ..#..#..##..#.#
            ##.##.##..##..#
                        
            ..#...#.#######
            #.##....#..##..
            ..###..########
            #....#.##..##..
            #....####..##..
            ..###..########
            #.##....#..##..
            ..#...#.#######
            ..####.###....#
            #####.###.####.
            .##..####......
            ...##...##.##.#
            #...###..######
                        
            #..#...#..#
            #......#..#
            .##......#.
            ####..#.###
            ..##..##...
            #.##.#.#..#
            #...##.###.
            ##.#...##..
            ##..###...#
            ##..###...#
            ##.#...##..
            #...##.###.
            #.##.#.#..#
                        
            .########....##..
            ###.##.###.##..##
            ..#.##.#..##.##.#
            .##....##..######
            ##.#.##.##..####.
            ##.#..#.##.#....#
            ..######.........
                        
            .##..##.#.#..#.
            #......########
            #########......
            #########.####.
            ###..###.#.##.#
            ##.######.####.
            ##.##.##.......
            .######..#....#
            ..####...##..##
            ########..#..#.
            ..#..#..##.##.#
            #.#..#.###....#
            ...##....#....#
            ...##....#.##.#
            #......##..##..
            #########.#..#.
            ...........##..
                        
            #....#..#.#.##.
            ...##.#...#####
            ...##.#....####
            #....#..#.#.##.
            ..###.###...##.
            #..##..##.##..#
            ##...#......##.
            .####.#..#.....
            .##.##.#....##.
            .#..#..#.##.##.
            ##.##.###......
            #..#.....##....
            #.#..#..#..####
            .###.#.#...####
            ...#....#######
            ..#.#.#...#.##.
            ...#........##.
                        
            .......##.......#
            #..###....###..#.
            ####.######.#####
            ....###..###.....
            .##..#....#..##..
            .##..#....#..##..
            #####.####.######
            .##.###..###.##.#
            .##.#..##..#.##..
            #..#........#..##
            ####.##..##.#####
            ###.##.##.##.###.
            ....###..###.....
                        
            .....#........#
            .....#........#
            ..###...#.#.#..
            ##.#.##....#..#
            ###..#.#.####.#
            .###....#..#..#
            ...#.#.#.#..##.
            ...#.#.#.#..##.
            .###....#.....#
                        
            #####.#
            .....##
            #####..
            #####..
            #..####
            ####.##
            ....#..
            ....#..
            ####.##
            #..####
            ######.
                        
            ##.##.#######
            .###.#...##..
            ###.##...##..
            ..#.#....##..
            #..###.######
            .#.#.#.#....#
            ...#...##..##
            ..##.##......
            ..##.####..##
            .##.##.##..##
            .#####.######
                        
            ....##...
            ..#....#.
            ....##...
            ####..###
            ####..###
            ##.#..#.#
            ..#....#.
            ###.....#
            ..#....#.
            ..##..##.
            ...####..
                        
            #########....
            ##.##.####...
            .#....#..#...
            #.#..#.##.#..
            .##..##..#...
            .########....
            #.####.#.....
            #..##..#.##..
            ########.....
            .######.#####
            .######...#..
            ..####..##...
            #.####.#.####
            #.####.#.....
            ...##......##
                        
            ...##.##.....#.
            ..###.##.....#.
            ....##.#..###.#
            ..####.#.###.#.
            ##...##..###.#.
            ##.####...##..#
            ###.##.####.#.#
            ...#....#.#....
            ##.#####..##.##
            ....##.#.###...
            ##.#.####.#.###
            ......##..##.##
            ####.#..####..#
                        
            .##..#.##
            #..##.##.
            #..##.###
            .##..#.##
            ####..##.
            ....#.###
            .##...#..
                        
            ...#..##..#..#..#
            .#.#..##..#..#..#
            #......#.#.##.#.#
            #...####.#.##.#.#
            ...###.###....###
            ...#.#...######..
            #..####..........
            ..##..##.#.##.#.#
            ##.#.#..#..##..#.
                        
            ####.#..#.####.
            .##..####..##..
            ##.##.##.##.###
            ..###.#..###...
            ##.#..##..#.##.
            ##..######..##.
            ...###..###...#
            ...###..###...#
            ##..######..##.
            ##.#..##..#.##.
            ..###.#..###...
                        
            ..##..##..#.##..#
            .####.###########
            .#..#.##........#
            .####.##..#..#..#
            ##..##.#.#.##.#.#
            #....#..###..###.
            ......#..........
                        
            #.#..##.###..##
            ####.#.#..#..#.
            ..##.#..###..##
            .#..##..##.##.#
            .#..#...#######
            ##.#.#####.##.#
            #.#.......#..#.
            #.#...#........
            #...#...#######
            #.#...#.#.#..#.
            .#...#..#.#..#.
            ##.#..##..#..#.
            ####..##..#..#.
                        
            ####..#...###..#.
            .##.#.#.##.######
            ..#.##...######.#
            ##.##..##.#####.#
            #.##....#........
            #.##....#........
            ##.##...#.#####.#
            ..#.##...###...##
            ..#.##...###...##
            ##.##...#.#####.#
            #.##....#........
            #.##....#........
            ##.##..##.#####.#
                        
            ####..###.######.
            #....##.####..###
            #....##.####..###
            ####..###.######.
            #..#.####.#.##.#.
            #####....#..##..#
            .#.#...#...#.##..
            ...##.#.#..#..#..
            #.#.#..#.#......#
            #.####.##........
            #.###...#..#..#..
            .#####.#.########
            ....#..#...####..
            .#..#.#.##.####.#
            ..##..#.#.#....#.
            .##.#..###.####.#
            .#....#..########
                        
            #..##...#..#....#
            ####.#.#....#..#.
            .#.....###.######
            ..####.##.##.##.#
            ..####.##.##.##.#
            .#.....##########
            ####.#.#....#..#.
            #..##...#..#....#
            #...######.######
            ##..#.#...##....#
            #....###.####..##
            #...##..###.####.
            .###..#....#.##.#
                        
            ..##.#..#.##...
            ..#.#....#.#...
            ..#.#....#.#...
            ..##.#..#.##...
            .####.##.####.#
            #.#.######.#.##
            #.#.#.##.#.#.##
            ..###.##.###.##
            #..##.##.##..##
            ##.##.##.##.##.
            ##..##..##..##.
                        
            #.###.##.#.#.##.#
            #..####....######
            ##...##..###....#
            ####..#.###.#..#.
            ##.##...#.#..#...
            ...#...##.#..##..
            ###.#.#.#.#..##..
            ..#..##.##.#.##.#
            .##.####.#.......
            .##.####.#.......
            ..#..##.##.#.##.#
            ###.#.#.#.#..##..
            ...#...##.#..##..
                        
            ....##...
            ....##...
            ####.#..#
            .##.#.#..
            ..#.###.#
            .##.#.###
            #####.###
            .##.###..
            #####.##.
                        
            .#.#......#######
            ###.###....#.####
            #...#.#.##...####
            .###.#..##...####
            #####....####....
            #.##..##.#...####
            #.#.###.#.....##.
            .##.###.#..#.....
            ###..#..##.#.####
            ..#.#.#..#.#.....
            .###....#........
            ####.#..##..#....
            #.##....#..#.####
            .###.###.#..#####
            .##..#.#..#######
                        
            ...#.####
            ....###.#
            #.#.#...#
            #.#.#...#
            ....#.#.#
            ...#.####
            ##.#..#.#
            ##..#....
            .#....###
            ##...#.##
            ##...#.##
            .#....###
            ##..#....
            ##.#..#.#
            ...#.####
            ....#.#.#
            #.#.#...#
                        
            ##..##..#######
            ..######.......
            ....##....####.
            ....##....####.
            #..#..#..######
            #.#....#.##..##
            ###....########
            ###....###....#
            .#......#..##..
            ...####...#..#.
            #.#....#.######
            #.#####..##..##
            ..#....#..#..#.
            ####..#########
            ...#..#...#..#.
                        
            ####...####
            ####...####
            ##...#....#
            .####..####
            ...##..#...
            .##.#.#..#.
            ##..#..#..#
            #.#..##.#.#
            .#..##..#.#
            ##.#####...
            ####.####..
            ####.####..
            ##.#####...
            .#..##..#.#
            ..#..##.#.#
                        
            #.#.#.#.###
            #...#.#.###
            .######.#.#
            ####......#
            ..#.##.###.
            .##...###..
            .##...###..
            ..#.##.###.
            ####......#
            .######.#.#
            #...#.#.###
                        
            ##..#.#
            ...#.##
            ...#.##
            .#..#.#
            ####..#
            .#####.
            .#####.
                        
            #.##.#.##....
            #######..####
            ....#.#.##..#
            ..##..##..##.
            ......###....
            .#..#.###....
            #######.##..#
            ########.....
            .#..#.##.####
            #.##.#...####
            #....#.#.#..#
            ##..##...####
            ##..##.######
                        
            #..##.#..##
            ##.##.#.###
            ####....#..
            ####....#..
            ##.##.#.###
            #..##.#..##
            #...#....#.
            ...##.####.
            ##..##...##
            .#...#.#...
            .###.#.##.#
            #..###..##.
            #..###...#.
            .###.#.##.#
            .#...#.#...
                        
            ..#.####.#..##.
            .....##.....###
            ..#.#..#.#...#.
            ##.#....#.####.
            .#........#.#.#
            ...##..##...##.
            ###.####.###..#
            ###......######
            ####.##.####.##
                        
            ...##....####....
            ########..##..###
            ########......###
            #......#..##..#..
            #.#..#.#..##..#.#
            #.#..#.########.#
            ...##...######...
            .#....#.######.#.
            #..##..##.##.###.
            #########....####
            ##....###....###.
                        
            ..#.##..######..#
            ..#.##..######..#
            ##.##..#..##..#..
            #...#.#..####..#.
            .....#..######..#
            .#.##.####..####.
            #...#.#.#....###.
            ##...#####..#####
            ..#..#.#..##..#.#
                        
            .......####
            ##..##.#.#.
            ##..###.#..
            #.##.##..##
            #....##..##
            .####.##...
            #######....
            ##..###....
            .#..#.##...
            .#..#.#..##
            ......###..
            ..##....#..
            ##..####.##
                        
            .##....#.
            ####....#
            .##..##..
            ...##..##
            ...##..##
            .##..##..
            ####....#
                        
            #.#.#.#.###
            ...##.....#
            .######.##.
            ......#.##.
            .#####.#...
            .#...##...#
            .#...##...#
            .#####.#...
            .#....#.##.
            .######.##.
            ...##.....#
            #.#.#.#.###
            ##.#.##.#.#
            .#.##..#.#.
            .#....###..
            .#....###..
            .#.##..#.#.
                        
            #....#.####..
            #.####.###..#
            .#..#.#..#.#.
            #.#..#....##.
            #######..####
            .#.#####.###.
            .#.#####.###.
            #######..####
            #.#..#....##.
            .#..#.#..#.#.
            #.########..#
            #....#.####..
            #....#.####..
                        
            .#...###.##.#
            .......######
            .##.##..#..##
            ....#.#...#..
            .##.###..#.##
            .##.####..#.#
            ####.###.#..#
            #..#.#....###
            ....##.....#.
            ....##.....#.
            #..#.#....###
                        
            .##.##..#......
            .#.#.....##.###
            .#.#.....##.###
            .##.##..#......
            ...#..##..#.#.#
            #####.#....#.##
            #####.###.#.###
            ..#.#.#.#..##..
            ..#.#.###..#...
                        
            #.#...##.##..
            ####.##.#####
            #...#....#.##
            ##..####.##..
            ##.#.#..#....
            .##..##.#..##
            .#..#.##.####
            .#..#.....#..
            #######.#####
            ##.##..#.....
            ##.##........
            #######.#####
            .#..#.....#..
            .#..#.##.####
            .##..##.#..##
            ##.#.#..#....
            ##..####.##..
                        
            ..#.###..###.#..#
            ..#.###..###.#..#
            ......#..#.......
            .#..##....##..#..
            .#.#...##...#.#.#
            ..#.#......#.#...
            ##............##.
            #.##........##.##
            ..###.#..#.###...
            .#....#..#....#..
            #...#.#..#.#...##
            ######.##.######.
            .#.##########.#.#
            ##.#.#.##.#.#.##.
            .#.#.##..##.#.#..
            #.############.##
            #####......###.#.
                        
            #..#...
            ..#####
            .#....#
            .#..###
            #...###
            .#.####
            .#.#...
            ...####
            .#.##..
            ..###..
            ...##..
            ...##..
            ..###..
            .#.##..
            ...####
                        
            #.#######....#.#.
            #..#.##.##......#
            ...#.##.##......#
            #.#######....#.#.
            #.#######....#.#.
            ...#.##.##......#
            #..#.##.##......#
            #.#######....#.#.
            ##.#.#######....#
            ###.###...##.#...
            #..#....#####....
            ..#.#..##.......#
            ###.######.#.#.#.
            .#.#####.........
            ...##.#..######..
            .###.#.##..#####.
            #...#.#..#.###.##
                        
            #...#.#
            ####...
            ####...
            #...#.#
            .....##
            ..##.##
            .##...#
            ..##...
            #.##.##
            ..###..
            ..###..
            #.##.##
            ..##...
            ..#...#
            ..##.##
                        
            .#..#..##.#...##.
            .#..#..##.#...##.
            #.#.#####..####.#
            ....#.##....#.##.
            .##.##.#.####....
            ###..###.....####
            #.##.#..##.......
                        
            .#.#.###.#.##
            #.###..#.#.##
            #####.#.###..
            #####.#.###..
            #.###..#.#.##
            .#.#.###.#.##
            #....##..#...
            #...####..###
            ##.#.###..#.#
            ##..#...#.###
            ##..#...#.###
            ##.#.###..#.#
            #...####..###
            #....##..#...
            .#.#.###.####
                        
            .##.##.
            #..#.#.
            ######.
            #..#...
            #..#..#
            #..#..#
            #..##..
            ######.
            #..#.#.
                        
            .##.#.##.#..#.##.
            .##.#.##.#..#.##.
            ###.#.##.#.##....
            #.#.##.....#.####
            ##..#.##.#######.
            ....#.##.#.###..#
            ..#......#.##....
            .#......###.#.##.
            #..#.###.#...#..#
                        
            ...##...#..##
            #.####.###...
            ...##.....#..
            .#.##.#..##..
            ##....###....
            ........#..##
            #......####..
            #..##..#.....
            ###..###..###
            .######..#...
            #.####.....##
                        
            ##....##..##..##.
            ...#####.#..#.###
            ####.##.######.##
            ..##...#..##..#..
            ##.#...########..
            ..##....##..##...
            ..#.#############
            ..####....##....#
            ###....##....##.#
            ..##.###.#..#.###
            ##...#.#......#.#
            ##..##.###..###.#
            ...#.#...####...#
            ...#...##.##.##..
            ###..##.##..##.##
            ..#.#..##....##..
            ..###.###....###.
                        
            ........#.###
            ..##...#####.
            .####.#.##..#
            .####.#..#.#.
            ##..####..#.#
            ##..##..#...#
            ##..##..#...#
            ##..####..#.#
            .####.#..#.#.
            .####.#.##..#
            ..##...#####.
            ........#.###
            ######.#.#..#
            ##..####..###
            #....#..#....
            #.##.#.#....#
            ##.####.###.#
                        
            #.#..#.#.#.#.####
            ###..#####....##.
            #..##..##..###..#
            #.######.###.#..#
            ########..#..####
            .#.##.#.##...####
            #.####.#.#..##..#
            ##....##..#..#..#
            ..####...##..#..#
            #.####.#.#.......
            ...##...###..#..#
            .#....#.###..#..#
            ..#..#..#.#..####
                        
            ...#...###.#.#...
            .......#....#..##
            .##.....##.####..
            .#..######.#.##..
            .#####.....###...
            .#...###..###..##
            ###.#..#....##...
            .#.####.#.#..#.##
            #.####..##.#.####
            #.#.##..##.#.####
            .#.####.#.#..#.##
                        
            .##.#....#..#..#.
            #....####....#...
            #.#...##...#.####
            .#...####...#.###
            #.##.####.##.#.##
            .#.##.##.##.#.#.#
            #..###..###..##.#
            #..###..###..##.#
            .#.##.##.##.#.#.#
            #.##.####.##.#.##
            .#...####...#.###
                        
            .#..#.##...
            .##..###...
            ####..##.##
            .......#.##
            .##.#.#....
            ....####...
            .##.#...#..
            ####.#.##..
            .##..##..##
                        
            .#.####..
            #..######
            ##.##....
            .##.##...
            .##.##...
            ##.##....
            #..######
            .#.####..
            #..#..###
            .#...####
            ##.......
            ##....#..
            #..#...##
            .###..###
            #...#...#
            .#..#....
            #.###....
                        
            .##.###.###.###
            .#####.##.#..##
            .#####.##.#..##
            .##.###.#######
            .#.##....##.###
            ##.###..#...###
            .#...#.#####.##
            ##.###...######
            .#.#.##....##..
            ##.#.#.##..#...
            ###.##..##.#...
            #####....###...
            #....#......###
                        
            .###...#.###.
            #...#.#.....#
            #...#.#.....#
            .###...#.###.
            .#..#....#..#
            #..###.##.#..
            #.##..#..#...
            #.######...#.
            #.######...#.
            #.##..#..#...
            ##.###.##.#..
            .#..#....#..#
            .###...#.###.
                        
            ......####.#...#.
            ......##.##..#.#.
            .#..#..#.####...#
            .#..#..##.##.####
            #.##.###..##..###
            #######.##..###..
            #.##.#....##..#..
            ..##...###.######
            ......##..##...##
            ......#.#...#.###
            ......#.#...#.###
            ......##..##.#.##
            ..##...###.######
                        
            #..#..#..
            .....####
            .##.#...#
            .##.#...#
            .....####
            #..#..#..
            ##.##.#..
            #..#..#..
            ......#.#
            .##...#..
            ####...#.
            #####.#.#
            #..#..#..
            .##..#...
            #####....
            #..#.####
            .......#.
                        
            .....#.#.
            ###...#..
            ..#..#.##
            ..###.##.
            ##.##....
            ##.##....
            ..###.##.
            ..#..#.##
            ###...#..
            ....##.#.
            ...######
                        
            ...##.##.#..####.
            ...##.##.#..####.
            #.####..#..#.....
            #..........#....#
            ..#.##...#..#..#.
            .#...##..#.#.##.#
            .#.#..##...##..##
            #...#...#########
            .#.##.#..###....#
                        
            ..#.##.
            ....###
            .....##
            ##...##
            ...#...
            ##..##.
            ###....
            ...##.#
            ##..#..
            ..##..#
            ..##..#
            ##..#.#
            ...##.#
                        
            #..#..#......#..#
            #..#..#......#..#
            ###.######.#..#.#
            .#.####.#.#####..
            ##..####..###.#..
            .##...###.#.#.##.
            ...#....#.#.#####
            ##.#..####..#....
            ##.#..###..#..##.
            ##.#..###..#..##.
            ##.#..####..#....
            ...#....#.#.#####
            .##...###.#.#.##.
            ##...###..###.#..
            .#.####.#.#####..
            ###.######.#..#.#
            #..#..#......#..#
                        
            ..#...#.#.##.
            .###.#....##.
            .##.#..######
            #.##.##.#....
            #######..####
            #.#.##..#....
            ##.#..#.##..#
            ..#....######
            ......#######
            ......#######
            ..#....######
            #..#..#.##..#
            #.#.##..#....
            #######..####
            #.##.##.#....
            .##.#..######
            .###.#....##.
                        
            ##..#..#..#
            ...#...##..
            ###..##..##
            ..#..##..#.
            ###.####.##
            ###..##..##
            ##.#.##.#.#
            ##.######.#
            ..########.
                        
            ##..###
            ####.##
            .#.#...
            .....##
            ..#.###
            ..#.###
            ###....
            ##.....
            ##...##
            ..#....
            ##.#...
            ###.#..
            ..#.###
                        
            ..##....#
            ...####.#
            ...##..##
            #####..##
            ...######
            ####....#
            .....##..
            ...#.##.#
            ##.#....#
                        
            ####...#.#.......
            #.#.####.####...#
            ..#.##.#...##....
            ..#.##.#...##....
            #.#.####.####...#
            ####...#.#.......
            #..#.#..#.#.#.##.
            .#....#....#..###
            ..#.##.#...#.#.#.
            ..#.##.#...#.#.#.
            .##...#....#..###
            #..#.#..#.#.#.##.
            ####...#.#.......
                        
            #.######.
            #.#....##
            .#..#.###
            .#..#.###
            #.#....##
            #.######.
            ......#.#
            .#....#.#
            #.######.
            #.#....##
            .#..#.###
                        
            .##...#..#...##..
            ##..#.####.#..###
            #......#.......##
            ##..#..##..#..###
            ..###..##..###...
            #..#..####..#..##
            #.##.#....#.##.##
            #.##.#....#.##.##
            .###.#....#.###..
            """;

}


